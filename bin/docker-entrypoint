#!/bin/bash -e

# Optionally prepare DB on boot.
# Keep this disabled by default; run migrations in a release task/job instead.
if [ "${RUN_DB_PREPARE_ON_BOOT:-0}" = "1" ] && \
   [ "${@: -2:1}" == "./bin/rails" ] && [ "${@: -1:1}" == "server" ]; then
  ./bin/rails db:prepare
fi

exec "${@}"
